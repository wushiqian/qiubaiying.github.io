---
layout:     post
title:      系统启动流程
subtitle:   Android
date:       2019-09-10
author:     wushiqian
header-img: img/post-bg-temple.jpg
catalog: true
tags:
    - Android
    - 系统
    - 源码
---

# Android系统启动

## init进程启动过程

### 引入init进程

* 启动电源以及系统启动
* 引导程序BootLoader

把系统OS拉起来并启动

* Linux内核启动

内核完成设置后，在系统文件寻找init.rc文件，并启动init进程

* init进程启动

### init进程的入口函数

1.挂载文件系统
2.对属性服务进行初始化
3.启动属性服务
4.设置子进程信号处理函数
5.解析init.rc文件

### 解析init.rc



### 解析Service类型语句

根据参数创建出Service对象，然后根据选项域的内容填充Service对象，最后将Service对象加入到vector类型的Service链表中。

### init启动Zygote

### 属性服务

### init进程启动总结

* 创建和挂载启动所需的文件目录
* 初始化和启动属性服务
* 解析init.rc配置文件并启动Zygote进程

## Zygote进程启动过程

### 概述

### Zygote启动脚本

- init.zygote32.rc
- init.zygote32_64.rc

### Zygote程序启动过程介绍

### Zygote进程启动总结

* 创建AppRuntime并调用其start方法，启动Zygote进程
* 创建Java虚拟机并未Java虚拟机注册JNI方法
* 通过JNI调用ZygoteInit的main函数进入Zygote的Java框架层
* 通过registerZygoteInit方法创建服务器端Socket，并通过runSelectLoop方法等待AMS的请求来创建新的应用程序进程
* 启动SystemServer进程

## SystemServer处理过程

SystemServer进程主要用于创建系统服务，AMS、WMS和PMS都是由它来创建的。

### Zygote处理SystemServer进程

#### 启动Binder线程池

#### 进入SystemServer的main方法

### 解析SystemServer进程

### 总结

1.启动Binder线程池，这样可以与其他进程进行通信。
2.启动SystemServiceManager，其用于对系统的服务进行创建、启动和生命周期管理。
3.启动各种系统服务。

## Launcher启动过程

### 概述

### 启动过程介绍

### Launcher中应用图标显示过程

## Android系统启动流程

